---
subject: 专业课843
chapter: 计算机网络
mastery: 0
next-review: 2026-03-05
status: 未开始
created: 2026-02-27
---

# 05 — 应用层

> 导航：[[02-科目/专业课/知识点/技术/计算机网络/00-网络MOC|网络MOC]] | 上：[[02-科目/专业课/知识点/技术/计算机网络/04-传输层|04-传输层]]

---

## 一、DNS（★★★）

### 基本概念

**域名系统（Domain Name System）**：将人类可读的域名（如 `www.example.com`）解析为 IP 地址

- 使用 **UDP 53端口**（查询），超过512字节或区域传输时使用 **TCP 53端口**
- 分布式、层次化数据库

### 域名层次结构

```
.（根域）
└── com（顶级域，TLD）
    └── example（二级域）
        └── www（三级域/主机名）
```

### DNS 服务器层次

| 层次 | 说明 |
|------|------|
| **根域名服务器** | 全球13组（A~M），知道所有顶级域服务器地址 |
| **顶级域（TLD）服务器** | 管理 .com/.cn/.org 等，知道权威DNS地址 |
| **权威 DNS 服务器** | 保存某个域的真实记录，最终给出IP |
| **本地 DNS 服务器** | 客户端配置的 DNS（如8.8.8.8），充当中间代理，有缓存 |

### 两种查询方式

**递归查询（Recursive Query）**：

```
客户端 → 本地DNS → 根DNS → TLD DNS → 权威DNS
        ←─────── 最终结果层层返回 ─────────────
```
- 本地DNS承担所有查询工作，客户端只等最终结果
- **客户端→本地DNS** 通常是递归查询

**迭代查询（Iterative Query）**：

```
客户端 → 本地DNS → 根DNS（返回：去问TLD）
              → TLD DNS（返回：去问权威）
              → 权威DNS（返回：IP地址）
        ← 本地DNS将IP返回给客户端
```
- 本地DNS接到"线索"后自己去问下一级
- **本地DNS→各级服务器** 通常是迭代查询

> 408典型考题：画出 www.example.com 的完整DNS解析过程（画图+标注查询类型）

### DNS 资源记录类型

| 类型 | 全称 | 用途 | 示例 |
|------|------|------|------|
| **A** | Address | 域名→IPv4地址 | `www.example.com → 1.2.3.4` |
| **AAAA** | IPv6 Address | 域名→IPv6地址 | — |
| **MX** | Mail Exchange | 域名→邮件服务器 | `example.com → mail.example.com` |
| **CNAME** | Canonical Name | 域名别名→真实域名 | `ftp.example.com → www.example.com` |
| **NS** | Name Server | 域名→权威DNS服务器 | `example.com → ns1.example.com` |
| **PTR** | Pointer | IP地址→域名（反向解析） | `1.2.3.4 → www.example.com` |

### DNS 缓存

- 查询结果在本地DNS和客户端缓存，有 **TTL（Time To Live）** 有效期
- 缓存减少查询延迟，但可能导致暂时返回旧记录（DNS传播延迟）

---

## 二、HTTP / HTTPS（★★★）

### HTTP 请求方法

| 方法 | 语义 | 是否幂等 | 是否有请求体 |
|------|------|----------|-------------|
| **GET** | 获取资源 | 是 | 否（参数在URL） |
| **POST** | 提交数据（创建资源） | 否 | 是 |
| **PUT** | 替换资源（全量更新） | 是 | 是 |
| **DELETE** | 删除资源 | 是 | 否 |
| **HEAD** | 只获取响应头（不要body） | 是 | 否 |
| **PATCH** | 部分更新资源 | 否 | 是 |
| **OPTIONS** | 查询服务器支持的方法 | 是 | 否 |

### HTTP 状态码

| 类别 | 含义 | 常见状态码 |
|------|------|-----------|
| **1xx** | 信息性（请求已收到，继续处理） | 100 Continue |
| **2xx** | 成功 | **200 OK**, 201 Created, 204 No Content |
| **3xx** | 重定向 | **301 永久重定向**, 302 临时重定向, 304 Not Modified |
| **4xx** | 客户端错误 | **400 Bad Request**, **403 Forbidden**, **404 Not Found** |
| **5xx** | 服务器错误 | **500 Internal Server Error**, 502 Bad Gateway, 503 Service Unavailable |

### HTTP 版本演进

| 版本 | 关键特性 | 问题 |
|------|----------|------|
| **HTTP/1.0** | 非持久连接（每个请求独立TCP连接） | 每次请求3次握手，开销大 |
| **HTTP/1.1** | 持久连接（Connection: keep-alive）、流水线（Pipeline）、分块传输 | 队头阻塞（HOL Blocking） |
| **HTTP/2.0** | 多路复用（Multiplexing）、头部压缩（HPACK）、服务器推送（Server Push）、二进制帧 | TCP 队头阻塞仍存在 |
| **HTTP/3.0** | 基于 QUIC（UDP实现）、彻底解决队头阻塞、0-RTT连接 | 较新，普及中 |

**持久连接** vs **流水线**：
- 持久连接：一个TCP连接发多个请求，但请求是串行的（等响应后才发下一个）
- 流水线：不等响应，连续发送多个请求，但响应仍需按序返回（仍有HOL问题）
- HTTP/2 多路复用：请求和响应可乱序，彻底解决 HOL

### Cookie 机制

**作用**：HTTP 是无状态协议，Cookie 用于在客户端保存状态信息

**流程**：
1. 服务器响应中设置 `Set-Cookie: session=abc123`
2. 浏览器保存 Cookie
3. 之后每次请求自动携带 `Cookie: session=abc123`

### HTTPS

- HTTP + **TLS/SSL** 加密，默认端口 **443**
- 提供：加密（防窃听）、完整性（防篡改）、身份认证（防伪装）
- TLS 握手过程：协商加密算法 → 服务器发证书 → 验证证书 → 交换密钥 → 建立加密通道

---

## 三、FTP（了解）

**文件传输协议（File Transfer Protocol）**，使用两个 TCP 连接：

| 连接 | 端口 | 作用 | 持续性 |
|------|------|------|--------|
| **控制连接** | 21 | 传输命令（登录、切换目录、传输指令） | 持续（整个会话） |
| **数据连接** | 20（主动）或随机（被动） | 实际传输文件 | 按需建立，用完关闭 |

### 主动模式（PORT）vs 被动模式（PASV）

**主动模式**：
- 客户端告诉服务器"我监听 X 端口"
- 服务器从 20 端口**主动连接**客户端 X 端口
- 问题：客户端在 NAT/防火墙后时，服务器无法主动连接客户端

**被动模式**：
- 客户端发 PASV 命令，服务器告知"我监听 Y 端口"
- 客户端**主动连接**服务器 Y 端口
- 解决了 NAT/防火墙问题，现代 FTP 客户端默认使用被动模式

---

## 四、SMTP / POP3 / IMAP（了解）

### 电子邮件系统架构

```
发件人 → [用户代理] → SMTP → [发送方邮件服务器] → SMTP → [接收方邮件服务器] → POP3/IMAP → [用户代理] → 收件人
```

### 三协议对比

| 协议 | 端口 | 传输层 | 方向 | 特点 |
|------|------|--------|------|------|
| **SMTP** | 25 (587 for submission) | TCP | 发送邮件（Push） | 只能发文本，附件需MIME编码 |
| **POP3** | 110 | TCP | 接收邮件（Pull） | 下载到本地，**默认删除**服务器副本 |
| **IMAP** | 143 | TCP | 接收邮件（Pull） | 保留服务器副本，支持多设备同步，可管理服务器上的邮件夹 |

**SMTP 的局限**：只能传输 ASCII 文本；附件通过 **MIME（多用途互联网邮件扩展）** 编码为 ASCII 后传输

---

## 五、高频错误（4条）

**错误1**：DNS 只使用 UDP

- 错：DNS 只用 UDP
- 正：DNS 通常用 **UDP 53**，但当响应超过 **512字节** 时（如区域传输），改用 **TCP 53**

**错误2**：HTTP/1.1 的流水线完全解决了队头阻塞

- 错：HTTP/1.1 流水线解决了队头阻塞
- 正：HTTP/1.1 流水线允许连续发送请求，但**响应必须按序返回**，仍存在队头阻塞；HTTP/2 的多路复用才真正解决

**错误3**：POP3 和 IMAP 都会在服务器保留邮件

- 错：POP3 也保留邮件副本
- 正：POP3 **默认下载后删除**服务器邮件（可配置保留）；IMAP **默认保留**服务器副本

**错误4**：HTTPS 只加密请求体，不加密 URL

- 错：HTTPS 只加密 POST 的 body
- 正：HTTPS 在 TLS 建立后，**整个 HTTP 报文**（包括 URL、请求头、请求体）都被加密

---

## 公式快查

| 协议 | 端口 | 传输层 | 关键特点 |
|------|------|--------|----------|
| HTTP | 80 | TCP | 无状态，明文 |
| HTTPS | 443 | TCP | HTTP + TLS，加密 |
| FTP控制 | 21 | TCP | 控制命令 |
| FTP数据 | 20（主动） | TCP | 文件传输 |
| SMTP | 25 | TCP | 发送邮件，Push |
| POP3 | 110 | TCP | 收取邮件，下载删除 |
| IMAP | 143 | TCP | 收取邮件，保留服务器 |
| DNS | 53 | UDP（大包TCP） | 域名解析 |
| DHCP服务端 | 67 | UDP | 自动分配IP |
| DHCP客户端 | 68 | UDP | — |
| TFTP | 69 | UDP | 简单文件传输 |
| TELNET | 23 | TCP | 远程登录（明文，已被SSH取代） |
| SSH | 22 | TCP | 加密远程登录 |

---

## 相关链接

- [[02-科目/专业课/知识点/技术/计算机网络/00-网络MOC|00-网络MOC]]
- [[02-科目/专业课/知识点/技术/计算机网络/04-传输层|04-传输层]]（HTTP/FTP 使用 TCP，DNS/DHCP 使用 UDP）
- [[02-科目/专业课/知识点/技术/计算机网络/03-网络层|03-网络层]]（DHCP 配置 IP 地址，DNS 解析为 IP）

---

## 错题汇总入口

> 在此记录应用层相关错题，每次复习后更新

- [ ] DNS 迭代查询与递归查询画图（常见综合题）
- [ ] HTTP 状态码辨析（301 vs 302 vs 304）
- [ ] HTTP/1.1 vs HTTP/2 特性对比选择题
- [ ] FTP 主动模式 vs 被动模式（NAT 场景判断）
