---
title: 排序算法
subject: 专业课843
chapter: 数据结构
status: 未开始
created: 2026-02-26
tags: [知识点, 843, 数据结构, 排序, 快速排序, 归并排序, 堆排序]
---

# 排序算法

> 843 A3数据结构 | 关联：[[02-树与二叉树]] · [[04-查找算法]] · [[01-线性结构]]

---

## 一、复杂度全表

| 算法 | 时间（平均）| 时间（最坏）| 时间（最好）| 空间 | 稳定性 |
|------|-----------|-----------|-----------|------|--------|
| **冒泡排序** | $O(n^2)$ | $O(n^2)$ | $O(n)$（已有序）| $O(1)$ | ✅ 稳定 |
| **选择排序** | $O(n^2)$ | $O(n^2)$ | $O(n^2)$ | $O(1)$ | ❌ 不稳定 |
| **插入排序** | $O(n^2)$ | $O(n^2)$ | $O(n)$（已有序）| $O(1)$ | ✅ 稳定 |
| **希尔排序** | $O(n^{1.3})$ | $O(n^2)$ | — | $O(1)$ | ❌ 不稳定 |
| **快速排序** | $O(n\log n)$ | $O(n^2)$（已有序）| $O(n\log n)$ | $O(\log n)$ | ❌ 不稳定 |
| **归并排序** | $O(n\log n)$ | $O(n\log n)$ | $O(n\log n)$ | $O(n)$ | ✅ 稳定 |
| **堆排序** | $O(n\log n)$ | $O(n\log n)$ | $O(n\log n)$ | $O(1)$ | ❌ 不稳定 |
| **计数排序** | $O(n+k)$ | $O(n+k)$ | — | $O(k)$ | ✅ 稳定 |

**记忆口诀**：
- **不稳定**：快（快排）希（希尔）选（选择）堆（堆排）
- **$O(n\log n)$ 且保证最坏**：归并、堆排（快排最坏是 $O(n^2)$）

---

## 二、各算法核心思路

### 冒泡排序
相邻元素两两比较，大的"冒"到右边。每轮确定一个最大值。
> 优化：若某轮无交换，则已有序，提前终止 → 最好 $O(n)$

### 插入排序
将元素逐一插入已排序区间的正确位置，类似摸牌整理。
> **小数组和近似有序数组效率高**；快速排序的递归底部常用插入排序优化

### 快速排序
分治法：选 pivot，将数组分为 $<$ pivot 和 $>$ pivot 两部分，递归排序。

**关键**：pivot选择影响性能
- 随机pivot：期望 $O(n\log n)$
- 每次选第一个（已有序数据）→ 退化 $O(n^2)$，递归深度 $O(n)$，栈溢出风险

### 归并排序
分治法：将数组二分，分别排序后**合并**有序数组。

**稳定 + 最坏 $O(n\log n)$**，但需要 $O(n)$ 额外空间。
适合链表排序（无需随机访问）和外部排序。

### 堆排序
1. 建最大堆：$O(n)$（与[[02-树与二叉树#堆]]直接关联）
2. 重复：将堆顶（最大值）与末尾交换，堆大小减1，再sift-down恢复堆

> 空间 $O(1)$，适合原地排序；但不稳定，实际缓存命中率低于快排

---

## 三、稳定性的实际意义

**稳定**：相等元素在排序后保持原来的相对顺序

> **应用场景**：先按部门排序，再按薪资排序 → 必须用稳定排序，保证同薪资人的部门顺序不乱

---

## 四、排序算法选择指南

| 场景 | 推荐算法 | 原因 |
|------|---------|------|
| 数据量小（$n<50$）| 插入排序 | 常数小，代码简单 |
| 通用高效 | 快速排序 | 实践最快（缓存友好）|
| 必须 $O(n\log n)$ 最坏保证 | 归并/堆排序 | 快排最坏 $O(n^2)$ |
| 必须稳定 | 归并排序 | 唯一稳定的 $O(n\log n)$ |
| 内存极度受限 | 堆排序 | $O(1)$ 额外空间 |
| 链表排序 | 归并排序 | 无需随机访问 |
| 已知数据范围小 | 计数排序 | $O(n+k)$ |

---

## 五、排序与查找的关系

> **与[[04-查找算法]]的双链**：
> - **二分查找的前提是有序数组**，排序是二分查找的预处理步骤
> - **BST中序遍历**（→[[02-树与二叉树]]）得到有序序列，等价于排序

---

## 公式快查

| 算法 | 平均 | 最坏 | 稳定 | 空间 |
|------|------|------|------|------|
| 快排 | $n\log n$ | $n^2$ | ❌ | $\log n$ |
| 归并 | $n\log n$ | $n\log n$ | ✅ | $n$ |
| 堆排 | $n\log n$ | $n\log n$ | ❌ | $1$ |
| 插入 | $n^2$ | $n^2$ | ✅ | $1$ |
| 冒泡 | $n^2$ | $n^2$ | ✅ | $1$ |

---

## 相关链接
- [[02-科目/专业课/知识点/技术/数据结构/02-树与二叉树|02-树与二叉树]]（堆排序基于堆；BST中序输出有序序列）
- [[02-科目/专业课/知识点/技术/数据结构/04-查找算法|04-查找算法]]（排序是二分查找的前提）
- [[02-科目/专业课/知识点/技术/数据结构/01-线性结构|01-线性结构]]（排序作用于数组/链表）
- [[02-科目/专业课/错题/错题汇总|错题汇总]]
