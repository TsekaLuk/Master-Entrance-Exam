---
title: 核心网络协议
subject: 专业课843
chapter: 网络软硬件技术
status: 未开始
created: 2026-02-26
tags: [知识点, 843, 计算机网络, TCP, HTTP, DNS]
---

# 核心网络协议

> 843 A4网络软硬件技术 | 关联：[[01-OSI与TCP-IP]] · [[03-Internet应用与组网]]

---

## 一、TCP 协议（传输控制协议）

### 三次握手（建立连接）

```
客户端                    服务端
  |  ——SYN(seq=x)——→  |   第1次：客户端发送SYN，进入SYN_SENT
  |  ←SYN+ACK(seq=y,ack=x+1)——  |   第2次：服务端回SYN+ACK，进入SYN_RCVD
  |  ——ACK(ack=y+1)——→  |   第3次：客户端确认，双方进入ESTABLISHED
```

> **为什么是三次而不是两次**：两次握手服务端无法确认客户端的接收能力；三次可防止历史连接初始化

### 四次挥手（断开连接）

```
客户端                    服务端
  |  ——FIN——→  |   客户端停止发数据
  |  ←ACK——    |   服务端确认（此时服务端可能还在发数据）
  |  ←FIN——    |   服务端也停止发数据
  |  ——ACK——→  |   客户端确认，进入TIME_WAIT（等2MSL后关闭）
```

> **为什么是四次而不是三次**：服务端的 ACK 和 FIN 不能合并，因为服务端可能还有数据要发

**TIME_WAIT 的作用**：等待 2MSL（最大段生存时间），确保最后一个 ACK 到达服务端，防止旧连接的数据包干扰新连接

### TCP 特性

| 特性 | 机制 |
|------|------|
| 可靠传输 | 确认应答（ACK）+ 超时重传 |
| 流量控制 | 滑动窗口（接收方控制发送速率）|
| 拥塞控制 | 慢开始 + 拥塞避免 + 快重传 + 快恢复 |
| 有序传输 | 序列号（seq）保证按序重组 |

---

## 二、UDP 协议（用户数据报协议）

| 特征 | 说明 |
|------|------|
| 无连接 | 不需握手，直接发送 |
| 不可靠 | 不保证到达、不保证顺序 |
| 速度快 | 无拥塞控制，无确认机制 |
| 报头小 | 仅8字节（TCP最小20字节）|

**适用场景**：视频直播、DNS查询、游戏（延迟敏感，丢包可容忍）

> **二级结论（TCP vs UDP 选择原则）**：
> - 可靠性优先 → TCP（文件传输、HTTP、邮件）
> - 速度/实时性优先 → UDP（DNS、音视频流、IoT传感器）

---

## 三、HTTP / HTTPS

### HTTP 特性

| 特征 | 说明 |
|------|------|
| 端口 | 80（HTTP）/ 443（HTTPS）|
| 无状态 | 每次请求独立，不记录历史 |
| 解决无状态 | Cookie（客户端存储）+ Session（服务端存储）|

### HTTP 方法

| 方法 | 含义 | 幂等性 |
|------|------|--------|
| GET | 获取资源 | ✅ 幂等 |
| POST | 提交数据（创建）| ❌ 非幂等 |
| PUT | 更新/替换整个资源 | ✅ 幂等 |
| PATCH | 部分更新 | ❌ 非幂等 |
| DELETE | 删除资源 | ✅ 幂等 |

### HTTP 版本演进

| 版本 | 关键改进 |
|------|---------|
| HTTP/1.0 | 每次请求新建连接（短连接）|
| HTTP/1.1 | 持久连接（keep-alive），管道化 |
| HTTP/2 | 多路复用（同一连接并发多请求），头部压缩，二进制帧 |
| HTTP/3 | 基于QUIC（UDP），彻底解决队头阻塞 |

### HTTPS

$$\text{HTTP} + \text{TLS/SSL} = \text{HTTPS}$$

**TLS 握手流程（简化）**：
1. 客户端发送支持的加密算法
2. 服务端回证书（含公钥）
3. 客户端验证证书，用公钥加密对称密钥
4. 双方用对称密钥加密通信

> **二级结论**：HTTPS 防止的是**中间人攻击**和**数据窃听**；性能代价是握手延迟（TLS 1.3已优化为1-RTT）

---

## 四、DNS（域名系统）

**作用**：域名 → IP 地址的分布式数据库

| 特征 | 说明 |
|------|------|
| 端口 | UDP 53（查询），TCP 53（区域传输）|
| 递归查询 | 本地DNS代替客户端逐级查询 |
| 迭代查询 | DNS服务器返回下一级DNS地址，客户端自行继续 |

**解析顺序**：浏览器缓存 → 操作系统缓存 → 本地DNS → 根域名服务器 → 顶级域（.com/.cn）→ 权威DNS

---

## 五、常用端口汇总

| 协议 | 端口 | 传输层 |
|------|------|--------|
| HTTP | 80 | TCP |
| HTTPS | 443 | TCP |
| FTP | 20(数据)/21(控制) | TCP |
| SSH | 22 | TCP |
| Telnet | 23 | TCP |
| SMTP | 25 | TCP |
| DNS | 53 | UDP |
| DHCP | 67/68 | UDP |
| POP3 | 110 | TCP |
| IMAP | 143 | TCP |

---

## 公式快查

| 知识点 | 要点 |
|--------|------|
| TCP 三次握手 | SYN → SYN+ACK → ACK |
| TCP 四次挥手 | FIN → ACK → FIN → ACK |
| TIME_WAIT | 等 2MSL，客户端主动关闭方 |
| HTTP无状态 | Cookie/Session解决 |
| HTTPS | HTTP + TLS，端口443 |
| DNS | UDP 53，递归/迭代查询 |

---

## 相关链接
- [[02-科目/专业课/知识点/技术/计算机网络/01-OSI与TCP-IP|01-OSI模型与TCP/IP]]（TCP在传输层，HTTP在应用层）
- [[02-科目/专业课/知识点/技术/计算机网络/03-Internet应用与组网|03-Internet应用与组网]]（IP地址、DNS、端口）
- [[02-科目/专业课/错题/错题汇总|错题汇总]]
